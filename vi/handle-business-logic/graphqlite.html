<!doctype html>
<html class="docs-version-current" lang="vi" dir="ltr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-beta.9">
<title data-react-helmet="true">GraphQLite | Hasura Extra</title><meta data-react-helmet="true" name="twitter:card" content="summary_large_image"><meta data-react-helmet="true" property="og:image" content="https://hasura-extra.github.io/vi/img/logo-text.png"><meta data-react-helmet="true" name="twitter:image" content="https://hasura-extra.github.io/vi/img/logo-text.png"><meta data-react-helmet="true" property="og:url" content="https://hasura-extra.github.io/vi/handle-business-logic/graphqlite"><meta data-react-helmet="true" name="docusaurus_locale" content="vi"><meta data-react-helmet="true" name="docusaurus_version" content="current"><meta data-react-helmet="true" name="docusaurus_tag" content="docs-default-current"><meta data-react-helmet="true" property="og:title" content="GraphQLite | Hasura Extra"><meta data-react-helmet="true" name="description" content="Hasura Extra tích hợp với GraphQLite để xây dựng GraphQL server handle business logic, nếu như bạn chưa biết về nó thì trước"><meta data-react-helmet="true" property="og:description" content="Hasura Extra tích hợp với GraphQLite để xây dựng GraphQL server handle business logic, nếu như bạn chưa biết về nó thì trước"><link data-react-helmet="true" rel="shortcut icon" href="/vi/img/favicon.ico"><link data-react-helmet="true" rel="canonical" href="https://hasura-extra.github.io/vi/handle-business-logic/graphqlite"><link data-react-helmet="true" rel="alternate" href="https://hasura-extra.github.io/handle-business-logic/graphqlite" hreflang="en"><link data-react-helmet="true" rel="alternate" href="https://hasura-extra.github.io/vi/handle-business-logic/graphqlite" hreflang="vi"><link data-react-helmet="true" rel="alternate" href="https://hasura-extra.github.io/handle-business-logic/graphqlite" hreflang="x-default"><link rel="stylesheet" href="/vi/assets/css/styles.12b9cb8b.css">
<link rel="preload" href="/vi/assets/js/runtime~main.5e8116e9.js" as="script">
<link rel="preload" href="/vi/assets/js/main.6f697f0a.js" as="script">
</head>
<body>
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div><a href="#" class="skipToContent_OuoZ">Nhảy tới nội dung</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/vi/"><div class="navbar__logo"><img src="/vi/img/logo.png" alt="Logo" class="themedImage_TMUO themedImage--light_4Vu1"><img src="/vi/img/logo.png" alt="Logo" class="themedImage_TMUO themedImage--dark_uzRr"></div><b class="navbar__title">Hasura Extra</b></a><a class="navbar__item navbar__link navbar__link--active" href="/vi/">Tài liệu</a><a class="navbar__item navbar__link" href="/vi/tutorial/introduction">Hướng dẫn</a></div><div class="navbar__items navbar__items--right"><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a href="#" class="navbar__link"><span><svg viewBox="0 0 20 20" width="20" height="20" aria-hidden="true" class="iconLanguage_EbrZ"><path fill="currentColor" d="M19.753 10.909c-.624-1.707-2.366-2.726-4.661-2.726-.09 0-.176.002-.262.006l-.016-2.063 3.525-.607c.115-.019.133-.119.109-.231-.023-.111-.167-.883-.188-.976-.027-.131-.102-.127-.207-.109-.104.018-3.25.461-3.25.461l-.013-2.078c-.001-.125-.069-.158-.194-.156l-1.025.016c-.105.002-.164.049-.162.148l.033 2.307s-3.061.527-3.144.543c-.084.014-.17.053-.151.143.019.09.19 1.094.208 1.172.018.08.072.129.188.107l2.924-.504.035 2.018c-1.077.281-1.801.824-2.256 1.303-.768.807-1.207 1.887-1.207 2.963 0 1.586.971 2.529 2.328 2.695 3.162.387 5.119-3.06 5.769-4.715 1.097 1.506.256 4.354-2.094 5.98-.043.029-.098.129-.033.207l.619.756c.08.096.206.059.256.023 2.51-1.73 3.661-4.515 2.869-6.683zm-7.386 3.188c-.966-.121-.944-.914-.944-1.453 0-.773.327-1.58.876-2.156a3.21 3.21 0 011.229-.799l.082 4.277a2.773 2.773 0 01-1.243.131zm2.427-.553l.046-4.109c.084-.004.166-.01.252-.01.773 0 1.494.145 1.885.361.391.217-1.023 2.713-2.183 3.758zm-8.95-7.668a.196.196 0 00-.196-.145h-1.95a.194.194 0 00-.194.144L.008 16.916c-.017.051-.011.076.062.076h1.733c.075 0 .099-.023.114-.072l1.008-3.318h3.496l1.008 3.318c.016.049.039.072.113.072h1.734c.072 0 .078-.025.062-.076-.014-.05-3.083-9.741-3.494-11.04zm-2.618 6.318l1.447-5.25 1.447 5.25H3.226z"></path></svg><span>Tiếng Việt</span></span></a><ul class="dropdown__menu"><li><a href="/handle-business-logic/graphqlite" target="_self" rel="noopener noreferrer" class="dropdown__link" style="text-transform:capitalize">English</a></li><li><a href="/vi/handle-business-logic/graphqlite" target="_self" rel="noopener noreferrer" class="dropdown__link dropdown__link--active" style="text-transform:capitalize">Tiếng Việt</a></li></ul></div><a href="https://github.com/hasura-extra" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link header-github-link" aria-label="GitHub repository"></a><div class="toggle_iYfV toggle_2i4l toggleDisabled_xj38"><div class="toggleTrack_t-f2" role="button" tabindex="-1"><div class="toggleTrackCheck_mk7D"><span class="toggleIcon_pHJ9">🌜</span></div><div class="toggleTrackX_dm8H"><span class="toggleIcon_pHJ9">🌞</span></div><div class="toggleTrackThumb_W6To"></div></div><input type="checkbox" class="toggleScreenReader_h9qa" aria-label="Switch between dark and light mode"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div class="main-wrapper docs-wrapper docs-doc-page"><div class="docPage_lDyR"><button aria-label="Trở lại đầu trang" class="clean-btn theme-back-to-top-button backToTopButton_i9tI" type="button"></button><aside class="docSidebarContainer_0YBq"><div class="sidebar_a3j0"><nav class="menu thin-scrollbar menu_cyFh"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/vi/">Giới thiệu</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Cài đặt</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><a class="menu__link menu__link--sublist menu__link--active" href="#">Handle business logic</a><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/vi/handle-business-logic/add-remote-schema">Thêm remote schema</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/vi/handle-business-logic/graphqlite">GraphQLite</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Handle event</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Authentication</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Code generation</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Manage metadata</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Deploying</a></li></ul></nav></div></aside><main class="docMainContainer_r8cw"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_zHA2"><div class="docItemContainer_oiyr"><article><div class="tocCollapsible_aw-L theme-doc-toc-mobile tocMobile_Tx6Y"><button type="button" class="clean-btn tocCollapsibleButton_zr6a">Trên trang này</button></div><div class="theme-doc-markdown markdown"><header><h1>GraphQLite</h1></header><p>Hasura Extra tích hợp với GraphQLite để xây dựng GraphQL server handle business logic, nếu như bạn chưa biết về nó thì trước
hết nên đọc tài liệu tại <a href="https://graphqlite.thecodingmachine.io/" target="_blank" rel="noopener noreferrer">đây</a>.</p><h2 class="anchor anchorWithStickyNavbar_y2LR" id="attributes">Attributes<a aria-hidden="true" class="hash-link" href="#attributes" title="Đường dẫn trực tiếp tới đề mục này">​</a></h2><p>Dưới đây là các attributes của GraphQLite mở rộng được Hasura Extra cung cấp</p><h3 class="anchor anchorWithStickyNavbar_y2LR" id="argnaming">ArgNaming<a aria-hidden="true" class="hash-link" href="#argnaming" title="Đường dẫn trực tiếp tới đề mục này">​</a></h3><p>Đây là một attribute dùng cho việc custom name của field arg (mặc định field arg không thay đổi được và lấy theo PHP arg).</p><p>Ví dụ chúng ta có resolver sau:</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI php"><pre tabindex="0" class="prism-code language-php codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token plain">use TheCodingMachine\GraphQLite\Annotations as GQL;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">class Resolver </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">{</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    #[GQL\Query(name: &#x27;arg_naming&#x27;)]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public function __invoke(string $camelCase): string </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        return &#x27;hello&#x27;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><button type="button" aria-label="Sao chép code vào bộ nhớ tạm" class="copyButton_M3SB clean-btn">Sao chép</button></div></div><p>Khi thực thi query get field <code>arg_naming</code> sẽ như sau:</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI GraphQL"><pre tabindex="0" class="prism-code language-GraphQL codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token plain">query {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    arg_naming(camelCase: &quot;test&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><button type="button" aria-label="Sao chép code vào bộ nhớ tạm" class="copyButton_M3SB clean-btn">Sao chép</button></div></div><p>Và chúng ta sẽ thay đổi field arg <code>camelCase</code> sang <code>camel_case</code>:</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI php"><pre tabindex="0" class="prism-code language-php codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token plain">use Hasura\GraphQLiteBridge\Attribute\ArgNaming;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">use TheCodingMachine\GraphQLite\Annotations as GQL;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">class Resolver </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">{</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    #[GQL\Query(name: &#x27;arg_naming&#x27;)]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    #[ArgNaming(for: &#x27;camelCase&#x27;, name: &#x27;camel_case&#x27;)]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public function __invoke(string $camelCase): string </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        return &#x27;hello&#x27;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><button type="button" aria-label="Sao chép code vào bộ nhớ tạm" class="copyButton_M3SB clean-btn">Sao chép</button></div></div><p>Câu query get field sẽ thành:</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI GraphQL"><pre tabindex="0" class="prism-code language-GraphQL codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token plain">query {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    arg_naming(camel_case: &quot;test&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><button type="button" aria-label="Sao chép code vào bộ nhớ tạm" class="copyButton_M3SB clean-btn">Sao chép</button></div></div><h3 class="anchor anchorWithStickyNavbar_y2LR" id="argentity">ArgEntity<a aria-hidden="true" class="hash-link" href="#argentity" title="Đường dẫn trực tiếp tới đề mục này">​</a></h3><div class="admonition admonition-caution alert alert--warning"><div class="admonition-heading"><h5><span class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"></path></svg></span>caution</h5></div><div class="admonition-content"><p>Attribute này chỉ dành cho Symfony bundle</p></div></div><p>Attribute này giúp bạn đơn giản hóa việc get Doctrine entity từ user input ví dụ:</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI php"><pre tabindex="0" class="prism-code language-php codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token plain">use App\Entity\MyEntity;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">use Doctrine\ORM\EntityManagerInterface;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">use TheCodingMachine\GraphQLite\Annotations as GQL;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">class Resolver </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">{</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public function __construct(private EntityManagerInterface $em)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    #[GQL\Query(name: &#x27;arg_entity&#x27;)]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public function __invoke(int $id): string </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        $entity = $this-&gt;em-&gt;getRepository(MyEntity::class)-&gt;find($id);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        return &#x27;hello&#x27;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><button type="button" aria-label="Sao chép code vào bộ nhớ tạm" class="copyButton_M3SB clean-btn">Sao chép</button></div></div><p>Resolver trên sẽ được đơn giản hóa khi sử dụng attribute <code>ArgEntity</code>:</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI php"><pre tabindex="0" class="prism-code language-php codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token plain">use App\Entity\MyEntity;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">use Hasura\Bundle\GraphQLite\Attribute\ArgEntity;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">use TheCodingMachine\GraphQLite\Annotations as GQL;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">class Resolver</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">{</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    #[GQL\Query(name: &#x27;arg_entity&#x27;)]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    #[ArgEntity(for: &#x27;entity&#x27;)]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public function __invoke(MyEntity $entity): string </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        return &#x27;hello&#x27;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><button type="button" aria-label="Sao chép code vào bộ nhớ tạm" class="copyButton_M3SB clean-btn">Sao chép</button></div></div><p>Mặc định <code>ArgEntity</code> sẽ sử dụng <code>id</code> là tên của arg, graphql input type là <code>ID</code>, search trên column name là <code>id</code> và Doctrine manager là <code>null</code> (default), trong trường hợp bạn muốn custom lại thì bạn có thể truyền thêm thông số:</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI php"><pre tabindex="0" class="prism-code language-php codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token plain">use App\Entity\Article;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">use Hasura\Bundle\GraphQLite\Attribute\ArgEntity;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">use TheCodingMachine\GraphQLite\Annotations as GQL;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">class Resolver</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">{</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    #[GQL\Query(name: &#x27;arg_entity&#x27;)]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    #[ArgEntity(for: &#x27;article&#x27;, argName: &#x27;article_id&#x27;, inputType: &#x27;Int!&#x27;, entityManager: &#x27;custom&#x27;)]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public function __invoke(Article $article): string </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        return &#x27;hello&#x27;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><button type="button" aria-label="Sao chép code vào bộ nhớ tạm" class="copyButton_M3SB clean-btn">Sao chép</button></div></div><h3 class="anchor anchorWithStickyNavbar_y2LR" id="objectassertion">ObjectAssertion<a aria-hidden="true" class="hash-link" href="#objectassertion" title="Đường dẫn trực tiếp tới đề mục này">​</a></h3><div class="admonition admonition-caution alert alert--warning"><div class="admonition-heading"><h5><span class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"></path></svg></span>caution</h5></div><div class="admonition-content"><p>Attribute này chỉ dành cho Symfony bundle</p></div></div><p>Attribute này giúp bạn validate object input</p><p>Giả sử như chúng ta có Input object sau:</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI php"><pre tabindex="0" class="prism-code language-php codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token plain">use TheCodingMachine\GraphQLite\Annotations as GQL;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">use Symfony\Component\Validator\Constraints as Assert;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#[GQL\Input]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">class Input </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">{</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    #[GQL\Field]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    #[Assert\NotBlank]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    #[Assert\Email]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public string $email;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><button type="button" aria-label="Sao chép code vào bộ nhớ tạm" class="copyButton_M3SB clean-btn">Sao chép</button></div></div><p>Và resolver sử dụng input object trên:</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI php"><pre tabindex="0" class="prism-code language-php codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token plain">use Hasura\Bundle\GraphQLite\Attribute\ObjectAssertion;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">use TheCodingMachine\GraphQLite\Annotations as GQL;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">class Resolver</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">{</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    #[GQL\Mutation(name: &#x27;object_assertion&#x27;)]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    #[ObjectAssertion(for: &#x27;input&#x27;)]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public function __invoke(Input $input): bool </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        return true;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><button type="button" aria-label="Sao chép code vào bộ nhớ tạm" class="copyButton_M3SB clean-btn">Sao chép</button></div></div><p>Khi query mutation field <code>object_assertion</code> mà trả về giá trị <code>true</code> đồng nghĩa với property <code>email</code> của input object
là chuỗi email không rỗng, ngược lại sẽ báo lỗi.</p><p>Mặc định <code>ObjectAssertion</code> sẽ thực thi validate trước khi resolver được gọi, bạn có thể bật mode
sau khi resolver được gọi và sử dụng kết hợp với <code>ArgEntity</code> để validate thêm 1 lần nữa. Ví dụ ta có
entity <code>User</code> như sau:</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI php"><pre tabindex="0" class="prism-code language-php codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token plain">namespace App\Entity;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">use Doctrine\ORM\Mapping as ORM;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">use Symfony\Bridge\Doctrine\Validator\Constraints\UniqueEntity;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#[ORM\Entity]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#[UniqueEntity(fields: &#x27;email&#x27;)]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">class User </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">{</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    #[ORM\Column(unique: true)]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    private $email;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public function setEmail(string $email): void </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        $this-&gt;email = $email;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><button type="button" aria-label="Sao chép code vào bộ nhớ tạm" class="copyButton_M3SB clean-btn">Sao chép</button></div></div><p>và mutation resolver <code>update_user</code> field như sau:</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI php"><pre tabindex="0" class="prism-code language-php codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token plain">use Hasura\Bundle\GraphQLite\Attribute\ArgEntity;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">use Hasura\Bundle\GraphQLite\Attribute\ObjectAssertion;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">use Hasura\Bundle\GraphQLite\Attribute\Transactional;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">use TheCodingMachine\GraphQLite\Annotations as GQL;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">class Resolver</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">{</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    #[GQL\Mutation(name: &#x27;update_user&#x27;)]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    #[ArgEntity(for: &#x27;user&#x27;)]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    #[ObjectAssertion(for: &#x27;input&#x27;)]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    #[ObjectAssertion(for: &#x27;user&#x27;, mode: ObjectAssertion::AFTER_RESOLVE_CALL)]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    #[Transactional]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public function __invoke(Input $input, User $user): bool </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        $user-&gt;setEmail($input-&gt;email);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        return true;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><button type="button" aria-label="Sao chép code vào bộ nhớ tạm" class="copyButton_M3SB clean-btn">Sao chép</button></div></div><p>Khi mutation field <code>update_user</code> được gọi property <code>email</code> của object input đã được validate và chúng ta sử dụng property đó để set email cho entity
User, tiếp đến resolver sẽ trả về <code>true</code> và đồng thời entity User sẽ được validate nếu như field <code>email</code> không tồn tại trên DB thì
entity sẽ được update và flush vào DB nhờ <code>Transactional</code> attribute xem thêm tại bên dưới, ngược lại sẽ báo lỗi <code>email</code> không unique.</p><h3 class="anchor anchorWithStickyNavbar_y2LR" id="transactional">Transactional<a aria-hidden="true" class="hash-link" href="#transactional" title="Đường dẫn trực tiếp tới đề mục này">​</a></h3><div class="admonition admonition-caution alert alert--warning"><div class="admonition-heading"><h5><span class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"></path></svg></span>caution</h5></div><div class="admonition-content"><p>Attribute này chỉ dành cho Symfony bundle</p></div></div><p>Attribute này sẽ wrap resolver của bạn trong một Doctrine transaction, nếu như có bất kỳ exception nào xảy ra trong resolver của bạn thì toàn bộ SQL query
sẽ được rollback, ngược lại nếu không, các entities đang managed bởi Entity Manager sẽ được flush vào database. Ngoài ra attribute này còn có tính năng
tự động persist đối với các entity vừa được khởi tạo (state new), ví dụ:</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI php"><pre tabindex="0" class="prism-code language-php codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token plain">use Hasura\Bundle\GraphQLite\Attribute\ObjectAssertion;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">use Hasura\Bundle\GraphQLite\Attribute\Transactional;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">use TheCodingMachine\GraphQLite\Annotations as GQL;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">class Resolver</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">{</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    #[GQL\Mutation(name: &#x27;insert_user&#x27;)]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    #[ObjectAssertion(for: &#x27;input&#x27;)]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    #[Transactional]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public function __invoke(Input $input): User </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        $user = new User();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        $user-&gt;setEmail($input-&gt;email);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        return $user;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><button type="button" aria-label="Sao chép code vào bộ nhớ tạm" class="copyButton_M3SB clean-btn">Sao chép</button></div></div><p>Khi mutation field <code>insert_user</code> được gọi thì object User sẽ được khởi tạo thông qua input object của end-user
và <code>Transactional</code> attribute sẽ tự động persist nó giúp bạn, sau đó sẽ flush vào database.</p><p>Nếu project của bạn có nhiều database connections thì bạn có thể chỉ định Entity Manager thông qua thông số <code>entityManager</code> như sau:</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI php"><pre tabindex="0" class="prism-code language-php codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token plain">#[Transactional(entityManager: &#x27;custom&#x27;)]</span><br></span></code></pre><button type="button" aria-label="Sao chép code vào bộ nhớ tạm" class="copyButton_M3SB clean-btn">Sao chép</button></div></div><h3 class="anchor anchorWithStickyNavbar_y2LR" id="roles">Roles<a aria-hidden="true" class="hash-link" href="#roles" title="Đường dẫn trực tiếp tới đề mục này">​</a></h3><p>Attribute này dùng cho authorization khác với <a href="https://graphqlite.thecodingmachine.io/docs/authentication-authorization#logged-and-right-annotations" target="_blank" rel="noopener noreferrer">Right</a> attribute,
nó hổ trợ bạn thêm được nhiều roles cùng 1 lúc và hổ trợ <a href="/vi/manage-metadata/persist-application-state-metadata">persist-state</a> sync roles lên remote schema permissions.</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI php"><pre tabindex="0" class="prism-code language-php codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token plain">use Hasura\GraphQLiteBridge\Attribute\Roles;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">use TheCodingMachine\GraphQLite\Annotations as GQL;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">class Resolver</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">{</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    #[GQL\Mutation(name: &#x27;hello&#x27;)]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    #[Roles(&#x27;ROLE_USER&#x27;, &#x27;ROLE_ADMIN&#x27;)]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public function __invoke(Input $input): string </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        return &#x27;world&#x27;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><button type="button" aria-label="Sao chép code vào bộ nhớ tạm" class="copyButton_M3SB clean-btn">Sao chép</button></div></div><h2 class="anchor anchorWithStickyNavbar_y2LR" id="scalar-types">Scalar types<a aria-hidden="true" class="hash-link" href="#scalar-types" title="Đường dẫn trực tiếp tới đề mục này">​</a></h2><p>Hasura Extra cung cấp <a href="https://graphqlite.thecodingmachine.io/docs/custom-types#registering-a-custom-scalar-type-advanced" target="_blank" rel="noopener noreferrer">custom scalar types</a> compatible với Hasura giúp cho việc tạo
<a href="https://hasura.io/docs/latest/graphql/core/databases/postgres/schema/remote-relationships/remote-schema-relationships.html" target="_blank" rel="noopener noreferrer">data federation</a>
thuận tiện hơn:</p><ul><li>json</li><li>jsonb</li><li>timestamptz</li><li>timetz</li><li>date</li><li>uuid</li></ul><p>Ngoài ra bạn còn có thể ứng dụng các type trên để validate user input format.</p><p>Cách sử dụng:</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI php"><pre tabindex="0" class="prism-code language-php codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token plain">#[Query(name: &#x27;test_scalar&#x27;, outputType: &#x27;json&#x27;)]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">public function __invoke(</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    #[UseInputType(inputType: &#x27;date&#x27;)] ?\DateTimeInterface $date = null,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    #[UseInputType(inputType: &#x27;json&#x27;)] ?array $json = null,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    #[UseInputType(inputType: &#x27;jsonb&#x27;)] ?array $jsonb = null,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    #[UseInputType(inputType: &#x27;timestamptz&#x27;)] ?\DateTimeInterface $timestamptz = null,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    #[UseInputType(inputType: &#x27;timetz&#x27;)] ?\DateTimeInterface $timetz = null,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    ?Uuid $uuid = null,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">): array {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    return compact(</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        &#x27;date&#x27;, </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        &#x27;json&#x27;, </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        &#x27;jsonb&#x27;, </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        &#x27;timestamptz&#x27;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        &#x27;timetz&#x27;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        &#x27;uuid&#x27;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    );</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><button type="button" aria-label="Sao chép code vào bộ nhớ tạm" class="copyButton_M3SB clean-btn">Sao chép</button></div></div></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-edit-meta-row row"><div class="col"><a href="https://github.com/hasura-extra/hasura-extra/edit/main/docusaurus/i18n/vi/docusaurus-plugin-content-docs/current/03-handle-business-logic/02-graphqlite.md" target="_blank" rel="noreferrer noopener" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_mS5F" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Sửa trang này</a></div><div class="col lastUpdated_mt2f"><span class="theme-last-updated">Cập nhật lần cuối <!-- --> vào <b><time datetime="2021-11-24T18:02:20.000Z">24/11/2021</time></b> bởi <!-- --> bởi <b>Minh Vuong</b></span></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Thanh điều hướng của trang tài liệu"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/vi/handle-business-logic/add-remote-schema"><div class="pagination-nav__sublabel">Trước</div><div class="pagination-nav__label">« <!-- -->Thêm remote schema</div></a></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/vi/handle-event/handle-table-event"><div class="pagination-nav__sublabel">Kế tiếp</div><div class="pagination-nav__label">Handle table event<!-- --> »</div></a></div></nav></div></div><div class="col col--3"><div class="tableOfContents_vrFS thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#attributes" class="table-of-contents__link toc-highlight">Attributes</a><ul><li><a href="#argnaming" class="table-of-contents__link toc-highlight">ArgNaming</a></li><li><a href="#argentity" class="table-of-contents__link toc-highlight">ArgEntity</a></li><li><a href="#objectassertion" class="table-of-contents__link toc-highlight">ObjectAssertion</a></li><li><a href="#transactional" class="table-of-contents__link toc-highlight">Transactional</a></li><li><a href="#roles" class="table-of-contents__link toc-highlight">Roles</a></li></ul></li><li><a href="#scalar-types" class="table-of-contents__link toc-highlight">Scalar types</a></li></ul></div></div></div></div></main></div></div><footer class="footer"><div class="container"><div class="footer__bottom text--center"><div class="margin-bottom--sm"><a class="footerLogoLink_SRtH" href="/vi/"><img src="/vi/img/logo-text.png" alt="" class="themedImage_TMUO themedImage--light_4Vu1 footer__logo"><img src="/vi/img/logo-text.png" alt="" class="themedImage_TMUO themedImage--dark_uzRr footer__logo"></a></div><div class="footer__copyright">Copyright © 2021 <a href="https://github.com/vuongxuongminh/">Minh Vuong.</a></div></div></div></footer></div>
<script src="/vi/assets/js/runtime~main.5e8116e9.js"></script>
<script src="/vi/assets/js/main.6f697f0a.js"></script>
</body>
</html>