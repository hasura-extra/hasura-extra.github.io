"use strict";(self.webpackChunkhasura_extra_github_io=self.webpackChunkhasura_extra_github_io||[]).push([[138],{1839:function(e,t,a){a.r(t),a.d(t,{frontMatter:function(){return o},contentTitle:function(){return l},metadata:function(){return c},toc:function(){return u},default:function(){return h}});var n=a(7462),r=a(3366),i=(a(7294),a(3905)),s=["components"],o={id:"laravel-access-control",title:"Laravel access control (authorization)",sidebar_label:"Laravel access control"},l=void 0,c={unversionedId:"security/laravel-access-control",id:"security/laravel-access-control",isDocsHomePage:!1,title:"Laravel access control (authorization)",description:"Hasura extra package cung c\u1ea5p s\u1eb5n cho b\u1ea1n authorization system th\xf4ng qua role access control, kh\xe1i ni\u1ec7m c\u1ee7a n\xf3 gi\u1ed1ng v\u1edbi Hasura,",source:"@site/i18n/vi/docusaurus-plugin-content-docs/current/05-security/04-laravel-access-control.md",sourceDirName:"05-security",slug:"/security/laravel-access-control",permalink:"/vi/security/laravel-access-control",editUrl:"https://github.com/hasura-extra/hasura-extra/edit/main/docusaurus/i18n/vi/docusaurus-plugin-content-docs/current/05-security/04-laravel-access-control.md",tags:[],version:"current",lastUpdatedBy:"Minh Vuong",lastUpdatedAt:1638641209,formattedLastUpdatedAt:"4/12/2021",sidebarPosition:4,frontMatter:{id:"laravel-access-control",title:"Laravel access control (authorization)",sidebar_label:"Laravel access control"},sidebar:"main",previous:{title:"Unauthenticated role",permalink:"/vi/security/unauthenticated-role"},next:{title:"Laravel Sanctum authentication",permalink:"/vi/security/laravel-sanctum-authentication"}},u=[{value:"\u0110\u1ecbnh ngh\u0129a roles",id:"\u0111\u1ecbnh-ngh\u0129a-roles",children:[],level:2},{value:"Inherited roles",id:"inherited-roles",children:[],level:2},{value:"Disable access control",id:"disable-access-control",children:[],level:2}],p={toc:u};function h(e){var t=e.components,a=(0,r.Z)(e,s);return(0,i.kt)("wrapper",(0,n.Z)({},p,a,{components:t,mdxType:"MDXLayout"}),(0,i.kt)("p",null,"Hasura extra package cung c\u1ea5p s\u1eb5n cho b\u1ea1n authorization system th\xf4ng qua role access control, kh\xe1i ni\u1ec7m c\u1ee7a n\xf3 gi\u1ed1ng v\u1edbi Hasura,\nm\u1ed7i request access v\xe0o system c\u1ee7a b\u1ea1n \u0111\u1ec1u ph\u1ea3i c\xf3 role k\u1ec3 c\u1ea3 ",(0,i.kt)("a",{parentName:"p",href:"/vi/security/unauthenticated-role"},"unauthenticated request c\u0169ng c\xf3 role"),"."),(0,i.kt)("h2",{id:"\u0111\u1ecbnh-ngh\u0129a-roles"},"\u0110\u1ecbnh ngh\u0129a roles"),(0,i.kt)("p",null,"\u0110\u1ec3 \u0111\u1ecbnh ngh\u0129a roles c\u1ee7a user b\u1ea1n h\xe3y t\u1ea1o method ",(0,i.kt)("inlineCode",{parentName:"p"},"getRoles")," trong Eloquent model ",(0,i.kt)("inlineCode",{parentName:"p"},"App\\Models\\User"),":"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-php",metastring:'title="app/Models/User.php"',title:'"app/Models/User.php"'},"<?php\n\nnamespace App\\Models;\n\nuse Illuminate\\Contracts\\Auth\\MustVerifyEmail;\nuse Illuminate\\Database\\Eloquent\\Factories\\HasFactory;\nuse Illuminate\\Foundation\\Auth\\User as Authenticatable;\nuse Illuminate\\Notifications\\Notifiable;\nuse Laravel\\Sanctum\\HasApiTokens;\n\nclass User extends Authenticatable\n{\n    /*\n     * List roles of user\n     */\n    public function getRoles(): array\n    {\n        return ['user'];\n    }\n    \n    ...\n}\n")),(0,i.kt)("p",null,"Method n\xe0y c\xf3 nhi\u1ec7m v\u1ee5 cung c\u1ea5p set roles c\u1ee7a user cho h\u1ec7 th\u1ed1ng, theo v\xed d\u1ee5 tr\xean roles fixed l\xe0 ",(0,i.kt)("inlineCode",{parentName:"p"},"['user']"),"\nb\u1ea1n c\xf3 th\u1ec3 l\u01b0u roles trong column json ho\u1eb7c t\u1ea1o li\xean k\u1ebft \u0111\u1ebfn table roles t\xf9y theo business logic c\u1ee7a project c\u1ee7a b\u1ea1n, v\xed d\u1ee5\nl\u01b0u khi roles tr\xean ",(0,i.kt)("inlineCode",{parentName:"p"},"json")," column:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-php",metastring:'title="app/Models/User.php"',title:'"app/Models/User.php"'},"/*\n * List roles of user\n */\npublic function getRoles(): array\n{\n    return $this->roles;\n}\n")),(0,i.kt)("p",null,"Sau khi \u0111\u1ecbnh ngh\u0129a xong b\u1ea1n c\xf3 th\u1ec3 x\xe0i c\xe1c ",(0,i.kt)("a",{parentName:"p",href:"https://laravel.com/docs/8.x/authorization#authorizing-actions-via-gates"},"authorization actions th\xf4ng qua Gate"),"\n\u0111\u1ec3 check roles c\u1ee7a user \u0111ang \u0111\u0103ng nh\u1eadp:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-php"},"use Illuminate\\Support\\Facades\\Gate;\n\nGate::allows('admin');\nGate::allows('manager');\nGate::allows('user');\n")),(0,i.kt)("p",null,"Ngo\xe0i ra role access system c\xf2n integrate v\u1edbi ",(0,i.kt)("a",{parentName:"p",href:"/vi/handle-business-logic/graphql-server/graphqlite-attributes#attributes-roles"},"Roles attribute c\u1ee7a GraphQLite")," \u0111\u1ec3\nb\u1ea1n c\xf3 th\u1ec3 d\u1ec5 d\xe0ng check authorization c\u1ee7a GraphQL query/mutation fields."),(0,i.kt)("h2",{id:"inherited-roles"},"Inherited roles"),(0,i.kt)("p",null,"B\u1ea1n c\xf3 th\u1ec3 \u0111\u1ecbnh ngh\u0129a inherited roles gi\u1ed1ng v\u1edbi kh\xe1i ni\u1ec7m ",(0,i.kt)("a",{parentName:"p",href:"https://hasura.io/docs/latest/graphql/core/auth/authorization/inherited-roles.html"},"inherited roles c\u1ee7a Hasura"),"\nt\u1ea1i ",(0,i.kt)("inlineCode",{parentName:"p"},"auth.inherited_roles")," trong file ",(0,i.kt)("inlineCode",{parentName:"p"},"config/hasura.php"),"."),(0,i.kt)("p",null,"V\xed d\u1ee5 ta thi\u1ebft l\u1eadp ",(0,i.kt)("inlineCode",{parentName:"p"},"inherited_roles")," nh\u01b0 sau:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-php",metastring:'title="config/hasura.php"',title:'"config/hasura.php"'},"'inherited_roles' => [\n    'admin' => ['manager', 'user'],\n],\n")),(0,i.kt)("p",null,"Theo v\xed d\u1ee5 tr\xean, n\u1ebfu user c\xf3 role ",(0,i.kt)("inlineCode",{parentName:"p"},"admin")," th\xec khi s\u1eed d\u1ee5ng ",(0,i.kt)("inlineCode",{parentName:"p"},"Gate::allows('manager')")," ho\u1eb7c ",(0,i.kt)("inlineCode",{parentName:"p"},"Gate::allows('user')")," \u0111\u1ec1u tr\u1ea3 v\u1ec1 ",(0,i.kt)("inlineCode",{parentName:"p"},"true")," v\xec role admin\n\u0111\u01b0\u1ee3c k\u1ebf th\u1eeba t\u1eeb role ",(0,i.kt)("inlineCode",{parentName:"p"},"manager")," v\xe0 ",(0,i.kt)("inlineCode",{parentName:"p"},"user"),"."),(0,i.kt)("p",null,"Roles inherited c\xf2n \u0111\u01b0\u1ee3c h\u1ed5 tr\u1ee3 ",(0,i.kt)("a",{parentName:"p",href:"/vi/manage-metadata/persist-application-state-metadata"},"persist state")," l\xean Hasura."),(0,i.kt)("h2",{id:"disable-access-control"},"Disable access control"),(0,i.kt)("p",null,"N\u1ebfu nh\u01b0 b\u1ea1n kh\xf4ng mu\u1ed1n Hasura Extra can thi\u1ec7p v\xe0o authorization system c\u1ee7a project c\u1ee7a b\u1ea1n th\xec b\u1ea1n c\xf3 th\u1ec3 t\u1eaft to\xe0n b\u1ed9 t\xednh n\u0103ng m\xf4 t\u1ea3 \u1edf tr\xean\nth\xf4ng qua option ",(0,i.kt)("inlineCode",{parentName:"p"},"auth.enabled_role_check_method")," trong file ",(0,i.kt)("inlineCode",{parentName:"p"},"config/hasura.php"),"."),(0,i.kt)("div",{className:"admonition admonition-warning alert alert--danger"},(0,i.kt)("div",{parentName:"div",className:"admonition-heading"},(0,i.kt)("h5",{parentName:"div"},(0,i.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,i.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"12",height:"16",viewBox:"0 0 12 16"},(0,i.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M5.05.31c.81 2.17.41 3.38-.52 4.31C3.55 5.67 1.98 6.45.9 7.98c-1.45 2.05-1.7 6.53 3.53 7.7-2.2-1.16-2.67-4.52-.3-6.61-.61 2.03.53 3.33 1.94 2.86 1.39-.47 2.3.53 2.27 1.67-.02.78-.31 1.44-1.13 1.81 3.42-.59 4.78-3.42 4.78-5.56 0-2.84-2.53-3.22-1.25-5.61-1.52.13-2.03 1.13-1.89 2.75.09 1.08-1.02 1.8-1.86 1.33-.67-.41-.66-1.19-.06-1.78C8.18 5.31 8.68 2.45 5.05.32L5.03.3l.02.01z"}))),"warning")),(0,i.kt)("div",{parentName:"div",className:"admonition-content"},(0,i.kt)("p",{parentName:"div"},"Khi b\u1ea1n t\u1eaft role access control system th\xec b\u1ea1n c\u1ea7n implements l\u1ea1i logic check role, n\u1ebfu kh\xf4ng h\u1ec7 th\u1ed1ng c\u1ee7a b\u1ea1n s\u1ebd KH\xd4NG b\u1ea3o m\u1eadt."))))}h.isMDXComponent=!0}}]);