<!doctype html>
<html class="docs-version-current" lang="vi" dir="ltr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-beta.9">
<title data-react-helmet="true">Laravel access control (authorization) | Hasura Extra</title><meta data-react-helmet="true" name="twitter:card" content="summary_large_image"><meta data-react-helmet="true" property="og:image" content="https://hasura-extra.github.io/vi/img/logo-text.png"><meta data-react-helmet="true" name="twitter:image" content="https://hasura-extra.github.io/vi/img/logo-text.png"><meta data-react-helmet="true" property="og:url" content="https://hasura-extra.github.io/vi/security/laravel-access-control"><meta data-react-helmet="true" name="docusaurus_locale" content="vi"><meta data-react-helmet="true" name="docusaurus_version" content="current"><meta data-react-helmet="true" name="docusaurus_tag" content="docs-default-current"><meta data-react-helmet="true" property="og:title" content="Laravel access control (authorization) | Hasura Extra"><meta data-react-helmet="true" name="description" content="Hasura extra package cung cấp sẵn cho bạn authorization system thông qua role access control, khái niệm của nó giống với Hasura,"><meta data-react-helmet="true" property="og:description" content="Hasura extra package cung cấp sẵn cho bạn authorization system thông qua role access control, khái niệm của nó giống với Hasura,"><link data-react-helmet="true" rel="shortcut icon" href="/vi/img/favicon.ico"><link data-react-helmet="true" rel="canonical" href="https://hasura-extra.github.io/vi/security/laravel-access-control"><link data-react-helmet="true" rel="alternate" href="https://hasura-extra.github.io/security/laravel-access-control" hreflang="en"><link data-react-helmet="true" rel="alternate" href="https://hasura-extra.github.io/vi/security/laravel-access-control" hreflang="vi"><link data-react-helmet="true" rel="alternate" href="https://hasura-extra.github.io/security/laravel-access-control" hreflang="x-default"><link rel="stylesheet" href="/vi/assets/css/styles.94743332.css">
<link rel="preload" href="/vi/assets/js/runtime~main.6ef248e6.js" as="script">
<link rel="preload" href="/vi/assets/js/main.83940ce7.js" as="script">
</head>
<body>
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div><a href="#" class="skipToContent_OuoZ">Nhảy tới nội dung</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/vi/"><div class="navbar__logo"><img src="/vi/img/logo.png" alt="Logo" class="themedImage_TMUO themedImage--light_4Vu1"><img src="/vi/img/logo.png" alt="Logo" class="themedImage_TMUO themedImage--dark_uzRr"></div><b class="navbar__title">Hasura Extra</b></a></div><div class="navbar__items navbar__items--right"><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a href="#" class="navbar__link"><span><svg viewBox="0 0 20 20" width="20" height="20" aria-hidden="true" class="iconLanguage_EbrZ"><path fill="currentColor" d="M19.753 10.909c-.624-1.707-2.366-2.726-4.661-2.726-.09 0-.176.002-.262.006l-.016-2.063 3.525-.607c.115-.019.133-.119.109-.231-.023-.111-.167-.883-.188-.976-.027-.131-.102-.127-.207-.109-.104.018-3.25.461-3.25.461l-.013-2.078c-.001-.125-.069-.158-.194-.156l-1.025.016c-.105.002-.164.049-.162.148l.033 2.307s-3.061.527-3.144.543c-.084.014-.17.053-.151.143.019.09.19 1.094.208 1.172.018.08.072.129.188.107l2.924-.504.035 2.018c-1.077.281-1.801.824-2.256 1.303-.768.807-1.207 1.887-1.207 2.963 0 1.586.971 2.529 2.328 2.695 3.162.387 5.119-3.06 5.769-4.715 1.097 1.506.256 4.354-2.094 5.98-.043.029-.098.129-.033.207l.619.756c.08.096.206.059.256.023 2.51-1.73 3.661-4.515 2.869-6.683zm-7.386 3.188c-.966-.121-.944-.914-.944-1.453 0-.773.327-1.58.876-2.156a3.21 3.21 0 011.229-.799l.082 4.277a2.773 2.773 0 01-1.243.131zm2.427-.553l.046-4.109c.084-.004.166-.01.252-.01.773 0 1.494.145 1.885.361.391.217-1.023 2.713-2.183 3.758zm-8.95-7.668a.196.196 0 00-.196-.145h-1.95a.194.194 0 00-.194.144L.008 16.916c-.017.051-.011.076.062.076h1.733c.075 0 .099-.023.114-.072l1.008-3.318h3.496l1.008 3.318c.016.049.039.072.113.072h1.734c.072 0 .078-.025.062-.076-.014-.05-3.083-9.741-3.494-11.04zm-2.618 6.318l1.447-5.25 1.447 5.25H3.226z"></path></svg><span>Tiếng Việt</span></span></a><ul class="dropdown__menu"><li><a href="/security/laravel-access-control" target="_self" rel="noopener noreferrer" class="dropdown__link" style="text-transform:capitalize">English</a></li><li><a href="/vi/security/laravel-access-control" target="_self" rel="noopener noreferrer" class="dropdown__link dropdown__link--active" style="text-transform:capitalize">Tiếng Việt</a></li></ul></div><a href="https://github.com/hasura-extra" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link header-github-link" aria-label="GitHub repository"></a><div class="toggle_iYfV toggle_2i4l toggleDisabled_xj38"><div class="toggleTrack_t-f2" role="button" tabindex="-1"><div class="toggleTrackCheck_mk7D"><span class="toggleIcon_pHJ9">🌜</span></div><div class="toggleTrackX_dm8H"><span class="toggleIcon_pHJ9">🌞</span></div><div class="toggleTrackThumb_W6To"></div></div><input type="checkbox" class="toggleScreenReader_h9qa" aria-label="Switch between dark and light mode"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div class="main-wrapper docs-wrapper docs-doc-page"><div class="docPage_lDyR"><button aria-label="Trở lại đầu trang" class="clean-btn theme-back-to-top-button backToTopButton_i9tI" type="button"></button><aside class="docSidebarContainer_0YBq"><div class="sidebar_a3j0"><nav class="menu thin-scrollbar menu_cyFh"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/vi/">Giới thiệu</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Cài đặt</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Handle business logic</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Events</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><a class="menu__link menu__link--sublist menu__link--active" href="#">Security</a><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/vi/security/webhook-authentication">Webhook authentication</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/vi/security/session-variable-enhancer">Session variable enhancer</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/vi/security/unauthenticated-role">Unauthenticated role</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/vi/security/laravel-access-control">Laravel access control</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/vi/security/laravel-sanctum-authentication">Laravel Sanctum authentication</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/vi/security/symfony-jwt-authentication">Symfony JWT authentication</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Code generation</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Manage metadata</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Deploying</a></li></ul></nav></div></aside><main class="docMainContainer_r8cw"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_zHA2"><div class="docItemContainer_oiyr"><article><div class="tocCollapsible_aw-L theme-doc-toc-mobile tocMobile_Tx6Y"><button type="button" class="clean-btn tocCollapsibleButton_zr6a">Trên trang này</button></div><div class="theme-doc-markdown markdown"><header><h1>Laravel access control (authorization)</h1></header><p>Hasura extra package cung cấp sẵn cho bạn authorization system thông qua role access control, khái niệm của nó giống với Hasura,
mỗi request access vào system của bạn đều phải có role kể cả <a href="/vi/security/unauthenticated-role">unauthenticated request cũng có role</a>.</p><h2 class="anchor anchorWithStickyNavbar_y2LR" id="định-nghĩa-roles">Định nghĩa roles<a aria-hidden="true" class="hash-link" href="#định-nghĩa-roles" title="Đường dẫn trực tiếp tới đề mục này">​</a></h2><p>Để định nghĩa roles của user bạn hãy tạo method <code>getRoles</code> trong Eloquent model <code>App\Models\User</code>:</p><div class="codeBlockContainer_J+bg"><div style="color:#393A34;background-color:#f6f8fa" class="codeBlockTitle_oQzk">app/Models/User.php</div><div class="codeBlockContent_csEI php"><pre tabindex="0" class="prism-code language-php codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token plain">&lt;?php</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">namespace App\Models;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">use Illuminate\Contracts\Auth\MustVerifyEmail;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">use Illuminate\Database\Eloquent\Factories\HasFactory;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">use Illuminate\Foundation\Auth\User as Authenticatable;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">use Illuminate\Notifications\Notifiable;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">use Laravel\Sanctum\HasApiTokens;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">class User extends Authenticatable</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">{</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    /*</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     * List roles of user</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     */</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public function getRoles(): array</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        return [&#x27;user&#x27;];</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    ...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><button type="button" aria-label="Sao chép code vào bộ nhớ tạm" class="copyButton_M3SB clean-btn">Sao chép</button></div></div><p>Method này có nhiệm vụ cung cấp set roles của user cho hệ thống, theo ví dụ trên roles fixed là <code>[&#x27;user&#x27;]</code>
bạn có thể lưu roles trong column json hoặc tạo liên kết đến table roles tùy theo business logic của project của bạn, ví dụ
lưu khi roles trên <code>json</code> column:</p><div class="codeBlockContainer_J+bg"><div style="color:#393A34;background-color:#f6f8fa" class="codeBlockTitle_oQzk">app/Models/User.php</div><div class="codeBlockContent_csEI php"><pre tabindex="0" class="prism-code language-php codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token plain">/*</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> * List roles of user</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> */</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">public function getRoles(): array</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">{</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    return $this-&gt;roles;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><button type="button" aria-label="Sao chép code vào bộ nhớ tạm" class="copyButton_M3SB clean-btn">Sao chép</button></div></div><p>Sau khi định nghĩa xong bạn có thể xài các <a href="https://laravel.com/docs/8.x/authorization#authorizing-actions-via-gates" target="_blank" rel="noopener noreferrer">authorization actions thông qua Gate</a>
để check roles của user đang đăng nhập:</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI php"><pre tabindex="0" class="prism-code language-php codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token plain">use Illuminate\Support\Facades\Gate;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Gate::allows(&#x27;admin&#x27;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Gate::allows(&#x27;manager&#x27;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Gate::allows(&#x27;user&#x27;);</span><br></span></code></pre><button type="button" aria-label="Sao chép code vào bộ nhớ tạm" class="copyButton_M3SB clean-btn">Sao chép</button></div></div><p>Ngoài ra role access system còn integrate với <a href="/vi/handle-business-logic/graphql-server/graphqlite-attributes#attributes-roles">Roles attribute của GraphQLite</a> để
bạn có thể dễ dàng check authorization của GraphQL query/mutation fields.</p><h2 class="anchor anchorWithStickyNavbar_y2LR" id="inherited-roles">Inherited roles<a aria-hidden="true" class="hash-link" href="#inherited-roles" title="Đường dẫn trực tiếp tới đề mục này">​</a></h2><p>Bạn có thể định nghĩa inherited roles giống với khái niệm <a href="https://hasura.io/docs/latest/graphql/core/auth/authorization/inherited-roles.html" target="_blank" rel="noopener noreferrer">inherited roles của Hasura</a>
tại <code>auth.inherited_roles</code> trong file <code>config/hasura.php</code>.</p><p>Ví dụ ta thiết lập <code>inherited_roles</code> như sau:</p><div class="codeBlockContainer_J+bg"><div style="color:#393A34;background-color:#f6f8fa" class="codeBlockTitle_oQzk">config/hasura.php</div><div class="codeBlockContent_csEI php"><pre tabindex="0" class="prism-code language-php codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token plain">&#x27;inherited_roles&#x27; =&gt; [</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &#x27;admin&#x27; =&gt; [&#x27;manager&#x27;, &#x27;user&#x27;],</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">],</span><br></span></code></pre><button type="button" aria-label="Sao chép code vào bộ nhớ tạm" class="copyButton_M3SB clean-btn">Sao chép</button></div></div><p>Theo ví dụ trên, nếu user có role <code>admin</code> thì khi sử dụng <code>Gate::allows(&#x27;manager&#x27;)</code> hoặc <code>Gate::allows(&#x27;user&#x27;)</code> đều trả về <code>true</code> vì role admin
được kế thừa từ role <code>manager</code> và <code>user</code>.</p><p>Roles inherited còn được hổ trợ <a href="/vi/manage-metadata/persist-application-state-metadata">persist state</a> lên Hasura.</p><h2 class="anchor anchorWithStickyNavbar_y2LR" id="disable-access-control">Disable access control<a aria-hidden="true" class="hash-link" href="#disable-access-control" title="Đường dẫn trực tiếp tới đề mục này">​</a></h2><p>Nếu như bạn không muốn Hasura Extra can thiệp vào authorization system của project của bạn thì bạn có thể tắt toàn bộ tính năng mô tả ở trên
thông qua option <code>auth.enabled_role_check_method</code> trong file <code>config/hasura.php</code>.</p><div class="admonition admonition-warning alert alert--danger"><div class="admonition-heading"><h5><span class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="12" height="16" viewBox="0 0 12 16"><path fill-rule="evenodd" d="M5.05.31c.81 2.17.41 3.38-.52 4.31C3.55 5.67 1.98 6.45.9 7.98c-1.45 2.05-1.7 6.53 3.53 7.7-2.2-1.16-2.67-4.52-.3-6.61-.61 2.03.53 3.33 1.94 2.86 1.39-.47 2.3.53 2.27 1.67-.02.78-.31 1.44-1.13 1.81 3.42-.59 4.78-3.42 4.78-5.56 0-2.84-2.53-3.22-1.25-5.61-1.52.13-2.03 1.13-1.89 2.75.09 1.08-1.02 1.8-1.86 1.33-.67-.41-.66-1.19-.06-1.78C8.18 5.31 8.68 2.45 5.05.32L5.03.3l.02.01z"></path></svg></span>warning</h5></div><div class="admonition-content"><p>Khi bạn tắt role access control system thì bạn cần implements lại logic check role, nếu không hệ thống của bạn sẽ KHÔNG bảo mật.</p></div></div></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-edit-meta-row row"><div class="col"><a href="https://github.com/hasura-extra/hasura-extra/edit/main/docusaurus/i18n/vi/docusaurus-plugin-content-docs/current/05-security/04-laravel-access-control.md" target="_blank" rel="noreferrer noopener" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_mS5F" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Sửa trang này</a></div><div class="col lastUpdated_mt2f"><span class="theme-last-updated">Cập nhật lần cuối <!-- --> vào <b><time datetime="2021-12-04T18:06:49.000Z">4/12/2021</time></b> bởi <!-- --> bởi <b>Minh Vuong</b></span></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Thanh điều hướng của trang tài liệu"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/vi/security/unauthenticated-role"><div class="pagination-nav__sublabel">Trước</div><div class="pagination-nav__label">« <!-- -->Unauthenticated role</div></a></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/vi/security/laravel-sanctum-authentication"><div class="pagination-nav__sublabel">Kế tiếp</div><div class="pagination-nav__label">Laravel Sanctum authentication<!-- --> »</div></a></div></nav></div></div><div class="col col--3"><div class="tableOfContents_vrFS thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#định-nghĩa-roles" class="table-of-contents__link toc-highlight">Định nghĩa roles</a></li><li><a href="#inherited-roles" class="table-of-contents__link toc-highlight">Inherited roles</a></li><li><a href="#disable-access-control" class="table-of-contents__link toc-highlight">Disable access control</a></li></ul></div></div></div></div></main></div></div><footer class="footer"><div class="container"><div class="footer__bottom text--center"><div class="margin-bottom--sm"><a class="footerLogoLink_SRtH" href="/vi/"><img src="/vi/img/logo-text.png" alt="" class="themedImage_TMUO themedImage--light_4Vu1 footer__logo"><img src="/vi/img/logo-text.png" alt="" class="themedImage_TMUO themedImage--dark_uzRr footer__logo"></a></div><div class="footer__copyright">Copyright © 2022 <a href="https://github.com/vuongxuongminh/">Minh Vuong.</a></div></div></div></footer></div>
<script src="/vi/assets/js/runtime~main.6ef248e6.js"></script>
<script src="/vi/assets/js/main.83940ce7.js"></script>
</body>
</html>